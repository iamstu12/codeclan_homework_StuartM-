---
title: "R Notebook"
output: html_notebook
---

# Homework - CIs

# MVP

Now we’ll go back to CI creation in the normal fashion. We’ll take the ames data from the CIs lab earlier today and regard it now as a sample, we won’t be drawing any smaller samples from within it. This is the usual situation in an analysis: you use all the data available to you!

# Part 1

Load the data again, clean_names(), and re-familiarise yourself with it

```{r}

library(tidyverse)
library(janitor)
library(infer)
library(fastGraph)

ames <- read_csv("data/ames.csv") %>% 
  clean_names()

head(ames)

```


# Part 2

Investigate the distribution of lot_area. Is the distribution roughly normal? If not, what problems do you find?

```{r}

ames %>% 
  ggplot(aes(x = lot_area)) +
  geom_histogram(aes(y = ..density..), col = "white", bins = 20, alpha = 0.7, fill = "grey40") +
  theme_light() +
  stat_function(
    fun = dnorm,
    args = list(
      mean = mean(ames$lot_area),
      sd = sd(ames$lot_area)
    ),
    colour = "dark green"
  )

```

# Part 3

Compute and visualise a bootstrap sampling distribution for the mean(lot_area) of the sold houses.

```{r}

nrow(ames)

names(ames)

bootstrap_resample <- ames %>% 
  rep_sample_n(size = 2930, replace = TRUE, reps = 2930) %>% 
  summarise(
    mean_lot_area = mean(lot_area)
  )

bootstrap_resample


```


```{r}

bootstrap_resample %>% 
  ggplot(aes(x = mean_lot_area)) +
  theme_light() +
  geom_histogram(aes(y = ..density..),col = "white", bins = 30, fill = "grey40", alpha = 0.8) +
  stat_function(
    fun = dnorm,
    args = list(
      mean = mean(bootstrap_resample$mean_lot_area),
      sd = sd(bootstrap_resample$mean_lot_area)
    ),
    col = "dark green"
  )

```

# Part 4

Use your bootstrap distribution to calculate a 95%
 CI for mean(lot_area), and visualise it on the distribution
 

```{r}

infer_resample <- ames %>% 
  specify(response = lot_area) %>% 
  generate(reps = 2930, type = "bootstrap") %>% 
  calculate(stat = "mean")

infer_ci_95 <- infer_resample %>% 
  get_ci(level = 0.95, type = "percentile")

infer_resample %>% 
  visualise() +
  shade_ci(endpoints = infer_ci_95)

```
 
# Part 5

You would like to know the mean(lot_area) of the sold houses with higher confidence. Calculate the 99% CI for this variable (you can re-use your bootstrap distribution from above). Is it narrower or broader than the 95% CI? Does that make sense?

```{r}

infer_ci_99 <- infer_resample %>% 
  get_ci(level = 0.99, type = "percentile")

infer_resample %>% 
  visualise() +
  shade_ci(endpoints = infer_ci_99)

```


# Part 6

Calculate the point estimate of the mean(lot_area)

```{r}

point_ests <- ames %>%
  rep_sample_n(size = 2930, reps = 1) %>%
  ungroup() %>%
  summarise(
    mean_lot_area = mean(lot_area)
  )
point_ests

```


# End of MVP























