---
title: "Simple Linear Regression Homework"
author: "Stuart McColl"
date: "05/01/2021"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
  word_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Part 1

### Load the data into a dataframe project

```{r, warning=FALSE, message=FALSE}

library(tidyverse)
library(modelr)
library(broom)
library(ggfortify)
library(infer)

project <- read_csv("data/project_management.csv")

```

<br>

# Part 2

### Plot the data, taking estimated_length as the independent variable and actual_length as the dependent variable.

```{r}

project %>% 
  ggplot(aes(x = estimated_length, y = actual_length)) +
  geom_point(col = "#666633") +
  theme_light() +
    labs(title = "Project Length Graph", subtitle = "Relationship between estimated project length and actual project length",
       x = "Estimated Length", y = "Actual Length")

```

<br>

# Part 3

### Calculate the correlation coefficient of estimated_length and actual_length and interpret the value you obtain.

```{r}

project %>% 
  summarise(cor = cor(estimated_length, actual_length))

```

#### A correlation coefficient of 0.80 is a very strong, positive correlation, which means that as the estimated length increases along the x-axis, the actual length also increases.

<br>

# Part 4 

### Perform a simple linear regression using actual_length as the dependent variable, and estimated_length as the independent variable. Save the model object to a variable.

```{r}

model <- lm(formula = actual_length ~ estimated_length, data = project)
model

```

<br>

# Part 5

### Interpret the regression coefficient of estimated_length (i.e. slope, gradient) you obtain from the model. How do you interpret the r2 value reported by the model?

<br>

#### Answer - fitted actual_length = 1.416 + 1.223 * estimated_length
#### 1x increase in estimated_length, changes the actual_length by 1.223.

<br>

# Part 6

### Is the relationship statistically significant? Remember, to assess this you need to check the p-value of the regression coefficient (or slope/gradient). But you should first check the regression diagnostic plots to see if the p-value will be reliable (don’t worry about any outlier points you see in the diagnostic plots, we’ll return to them in the extension).

```{r}

project %>%
  ggplot(aes(x = estimated_length, y = actual_length)) +
  geom_point(col = "#666633") +
  geom_abline(
    intercept = model$coefficients[1],
    slope = model$coefficients[2],
    col = "#cc9900"
  ) +
  theme_light() +
  labs(title = "Project Length Graph", subtitle = "Relationship between estimated project length and actual project length",
       x = "Estimated Length", y = "Actual Length", caption = "*** Yellow line = Best Fit ***")

```


```{r}

glance <- glance(model)

glance$p.value

```

<br>

#### Answer - As the p-value is less than a significance level of both 0.01 and 0.05 (typic), the coefficient is significantly different from zero.

<br>
<hr>
















