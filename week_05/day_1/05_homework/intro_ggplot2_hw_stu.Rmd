---
title: "R Notebook"
output: html_notebook
---

# Introduction to ggplot2 homework

# Question 1.

Load in the libraries you need, and look at the backpack data. Take note of variable names and dimensions.

```{r}

library(tidyverse)
library(CodeClanData)

```

```{r}

backpack <- backpack

```

```{r}

names(backpack)

```


```{r}

glimpse(backpack)

```

# Question 2.

What is the distribution of backpack weights that students are carrying? Choose an appropriate graph to show the distribution.


```{r}

ggplot(backpack) +
  aes(x = backpack_weight) +
  geom_histogram(bins = 20, col = "white", fill = "dark green") + 
  theme_light() + 
  labs(y = "number of backpacks", x = "weight")

```

From the graph above, you will see that there is a higher count of backpacks that are 10 and below. As the bag gets heavier, there is a smaller count.

# Question 3.

Are there differences in backpack weight between sex?

```{r}

ggplot(backpack) +
  aes(x = backpack_weight, fill = sex) +
  scale_fill_manual(values=c('#E69F00', '#56B4E9')) +
  geom_histogram(bins = 20, col = "white") + 
  theme_light() + 
  labs(y = "number of backpacks", x = "weight") + 
  facet_wrap(~sex)

```

From the results above, you will see that there is a higher count of backpacks for females. You can also see that there are specific weights that only the males are carrying - just over 10 is most popular and they do carry heavier bags compared to females.

# Question 4.

What is the relationship between body weight and backpack weight?

```{r}

ggplot(backpack) + 
  aes(x = body_weight, y = backpack_weight) + 
  geom_point() + 
  labs(x = "body weight", y = "backpack weight")
  

```

As you can see from the results above, there is a trend that as the body weight goes up to around 160, the weight of the backpack increases and then drops off.


# Question 5.

Is this relationship different between men and women? Choose an appropriate plot and interpret your findings.

```{r}

ggplot(backpack) + 
  aes(x = body_weight, y = backpack_weight, color = sex) + 
  geom_point() + 
  facet_wrap(~sex) + 
    scale_color_manual(values=c('#E69F00', '#56B4E9'))+
    labs(x = "body weight", y = "backpack weight")

```

From the results above you can see that as you get to the female weight of around 175 it drops off, whereas the males are almost 200 by the time the backpack weight drops, and is 10 heavier.

# Question 6.

What proportion of students report back pain?

```{r}

backpack <- backpack %>%
  mutate(backpain_labelled = recode(back_problems, 
                       "0" = "No", 
                       "1" = "Yes"))

ggplot(backpack) + 
  aes(x = backpain_labelled, fill = backpain_labelled) + 
  geom_bar() +
ylim(0,100) + 
  labs(x = "backpain reported", y = "student count") +
    scale_fill_manual(values=c('#f0ca41', '#5022bd'))+
theme(legend.position = "none")

```



```{r}

back_problems <- backpack %>%
  mutate(back_problems = if_else(back_problems == "1", "Yes", "No")) %>% 
  group_by(back_problems) %>% 
  summarise(back_problems_count = n())

ggplot(back_problems) +
  geom_bar(aes(x = back_problems, y = back_problems_count, fill = back_problems), stat = "identity")
  

```

# Question 7.

Is this proportion different between men and women?

```{r}

ggplot(backpack) + 
  aes(x = backpain_labelled, fill = backpain_labelled) + 
  geom_bar() +
  labs(x = "backpain reported", y = "student count") + 
  facet_wrap(~sex) +
      scale_fill_manual(values=c('#f0ca41', '#5022bd'))+
theme(legend.position = "none")
  

```


```{r}
backpack %>%
  filter(back_problems == 1) %>% 
  group_by(sex, back_problems) %>%
  summarise(back_problems = n())
```


```{r}

backpack_back_problems <- backpack %>%
  filter(back_problems == 1) %>% 
  group_by(sex) %>%
  summarise(back_problems = n())

ggplot(backpack_back_problems) +
  geom_bar(aes(x = sex, y = back_problems, fill = sex), stat = "identity")


```

# Question 8.

Now youâ€™ve investigated your data separately, create plots to describe the relationship between backpack weight, body weight, gender and reported backpain.

Try both backpack_weight and body_weight as well as the ratio.


```{r}

pain_labels <- c("backpain: no", "backpain: yes")
names(pain_labels) <- c("No", "Yes")

sex_labels <- c("sex: female", "sex: male")
names(sex_labels) <- c("Female", "Male")


ggplot(backpack) + 
  aes(x = body_weight, y = backpack_weight, color = backpain_labelled) + 
  geom_point() + 
  facet_grid(sex ~ backpain_labelled, 
             labeller = labeller(backpain_labelled = pain_labels, sex = sex_labels)) + 
  labs(x = "\n body weight", y = "backpack weight \n") +
      scale_color_manual(values=c('#f0ca41', '#5022bd'))+
theme(legend.position = "none")

```


# End

 








