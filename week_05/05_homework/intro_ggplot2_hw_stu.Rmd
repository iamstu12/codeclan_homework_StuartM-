---
title: "R Notebook"
output: html_notebook
---

# Introduction to ggplot2 homework

# Question 1.

Load in the libraries you need, and look at the backpack data. Take note of variable names and dimensions.

```{r}

library(tidyverse)
library(CodeClanData)

```

```{r}

backpack <- backpack

```

```{r}

names(backpack)

```


```{r}

glimpse(backpack)

```

# Question 2.

What is the distribution of backpack weights that students are carrying? Choose an appropriate graph to show the distribution.


```{r}

ggplot(backpack) +
  geom_bar(aes(x = backpack_weight), fill = "light blue")

```

From the graph above, you will see that there is a higher count of backpacks that are 10 and below. As the bag gets heavier, there is a smaller count.

# Question 3.

Are there differences in backpack weight between sex?



```{r}

ggplot(backpack) +
  geom_bar(aes(x = backpack_weight, fill = sex), position = "fill")

```

From the results above, you will see that there is a higher count of backpacks for females. You can also see that there are specific weights that only the males are carrying - just over 10 is most popular and they do carry heavier bags compared to females.

# Question 4.

What is the relationship between body weight and backpack weight?

```{r}

ggplot(backpack) +
  geom_bar(aes(x = body_weight, y = backpack_weight), fill = "light blue", stat = "identity", position = "dodge")
  

```

As you can see from the results above, there is a trend that as the body weight goes up to around 160, the weight of the backpack increases and then drops off.


# Question 5.

Is this relationship different between men and women? Choose an appropriate plot and interpret your findings.

```{r}

ggplot(backpack) +
  geom_bar(aes(x = body_weight, y = backpack_weight, fill = sex), stat = "identity", position = "dodge")

```

From the results above you can see that as you get to the female weight of around 175 it drops off, whereas the males are almost 200 by the time the backpack weight drops, and is 10 heavier.

# Question 6.

What proportion of students report back pain?


```{r}

back_problems <- backpack %>%
  mutate(back_problems = if_else(back_problems == "1", "Yes", "No")) %>% 
  group_by(back_problems) %>% 
  summarise(back_problems_count = n())

ggplot(back_problems) +
  geom_bar(aes(x = back_problems, y = back_problems_count, fill = back_problems), stat = "identity")
  

```

# Question 7.

Is this proportion different between men and women?

```{r}
backpack %>%
  filter(back_problems == 1) %>% 
  group_by(sex, back_problems) %>%
  summarise(back_problems = n())
```


```{r}

backpack_back_problems <- backpack %>%
  filter(back_problems == 1) %>% 
  group_by(sex) %>%
  summarise(back_problems = n())

ggplot(backpack_back_problems) +
  geom_bar(aes(x = sex, y = back_problems, fill = sex), stat = "identity")


```

# Question 8.

Now youâ€™ve investigated your data separately, create plots to describe the relationship between backpack weight, body weight, gender and reported backpain.

Try both backpack_weight and body_weight as well as the ratio.



 








