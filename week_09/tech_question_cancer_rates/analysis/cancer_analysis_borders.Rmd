---
title: "Cancer Incidences Borders"
author: "Stuart McColl"
date: "14/12/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Analysis

```{r, warning = FALSE, message = FALSE, echo = FALSE}

library(tidyverse)

health_board_level_clean <-
  read_csv("/Users/Natifu/codeclan_homework_StuartM/week_09/tech_question_cancer_rates/clean_data/health_board_level_clean")

scotland_level_clean <-
  read_csv("/Users/Natifu/codeclan_homework_StuartM/week_09/tech_question_cancer_rates/clean_data/scotland_level_clean")


```


### Show Number of Incidences Across Scotland Over Time

```{r,echo = FALSE}

scotland_level_clean %>% 
  filter(cancer_type == "All") %>% 
  filter(age_group == "All") %>% 
  ggplot(aes(x = year, y = number_of_incidences, colour = sex)) +
  geom_point() +
  geom_line() +
  scale_x_continuous(breaks = c(1994, 1995, 1996, 1997, 1998, 1999,
                                2000, 2001, 2002, 2003, 2004, 2005, 2006,
                                2007, 2008, 2009, 2010, 2011, 2012, 2013,
                                2014, 2015, 2016, 2017, 2018)) +
  labs(x = "Year", y = "Number of Incidences", title = "Number of Cancer Incideneces Across Scotland") +
  theme_light() +
  theme(axis.text.x = element_text(angle = 90))
  


```

#### Results
#### As you can see from the graph above; Scotland has experienced a slight increase over the last 25 years.

### Show Number of Incidences in Each Health Board Over Time
#### From 1994 to 2018:

```{r, echo=FALSE, warning=FALSE, message=FALSE}

health_board_level_clean %>% 
  group_by(health_board_name) %>% 
  filter(cancer_type == "All") %>% 
  filter(year == 2018) %>% 
  summarise(total_number_of_incidences = sum(number_of_incidences)) %>% 
  arrange(desc(total_number_of_incidences)) 
  

```
#### Results
#### As you can see from the table above; Glasgow has accumulated the highest number of incideneces.

### Show Number of Incidences in Borders Over Time for All Cancer
#### From 1994 to 2018:

```{r, echo=FALSE, warning=FALSE, message=FALSE}

health_board_level_clean %>% 
  filter(health_board_name == "NHS Borders") %>% 
  filter(cancer_type == "All") %>% 
  filter(age_group == "All") %>% 
  ggplot(aes(x = year, y = number_of_incidences, colour = sex)) +
  geom_point() +
  geom_line() +
  scale_x_continuous(breaks = c(1994, 1995, 1996, 1997, 1998, 1999,
                                2000, 2001, 2002, 2003, 2004, 2005, 2006,
                                2007, 2008, 2009, 2010, 2011, 2012, 2013,
                                2014, 2015, 2016, 2017, 2018)) +
  labs(x = "Year", y = "Number of Incidences", title = "Number of Cancer Incideneces in the Borders") +
  theme_light() +
  theme(axis.text.x = element_text(angle = 90))

```


```{r, echo=FALSE, warning=FALSE, message=FALSE}

health_board_level_clean %>% 
  filter(cancer_type == "All") %>% 
  filter(age_group == "All") %>% 
  filter(sex == "All") %>% 
  ggplot(aes(x = year, y = number_of_incidences, colour = health_board_name)) +
  geom_point() +
  geom_line() +
  scale_x_continuous(breaks = c(1994, 1995, 1996, 1997, 1998, 1999,
                                2000, 2001, 2002, 2003, 2004, 2005, 2006,
                                2007, 2008, 2009, 2010, 2011, 2012, 2013,
                                2014, 2015, 2016, 2017, 2018)) +
  labs(x = "Year", y = "Number of Incidences", title = "Number of Cancer Incideneces in the Borders") +
  theme_light() +
  scale_colour_manual(
    values = c(
      "NHS Ayrshire and Arran" = "Grey80",
      "NHS Borders" = "Dark Green",
      "NHS Dumfries and Galloway" = "Grey80",
      "NHS Fife" = "Grey80",
      "NHS Forth Valley" = "Grey80",
      "NHS Grampian" = "Grey80",
      "NHS Greater Glasgow and Clyde" = "Grey80",
      "NHS Highland" = "Grey80",
      "NHS Lanarkshire" = "Grey80",
      "NHS Lothian" = "Grey80",
      "NHS Orkney" = "Grey80",
      "NHS Shetland" = "Grey80",
      "NHS Tayside" = "Grey80",
      "NHS Western Isles" = "Grey80"
    )) +
  theme(axis.text.x = element_text(angle = 90), legend.position = "none")


```


#### Results
#### As you can see from the graphs above, the borders have experienced a slight increase in the number of incidences. 

### Show Number of Incidences in Borders Over Time for Individual Cancers

```{r, echo=FALSE, warning=FALSE, message=FALSE}

health_board_level_clean %>% 
  filter(age_group == "All") %>% 
  filter(cancer_type != "All") %>% 
  filter(sex == "All") %>% 
  filter(health_board_name == "NHS Borders") %>% 
  group_by(cancer_type) %>% 
  summarise(total_number_of_incidences = sum(number_of_incidences)) %>% 
  arrange(desc(total_number_of_incidences))
 

```

#### Results
#### As you can see from the table above, Non-melanoma skin cancer has the highest number of recorded incidences.

### Show Years that are Below or Above the Average for Borders

```{r, echo=FALSE, warning=FALSE, message=FALSE}

health_board_level_clean %>% 
  filter(age_group == "All") %>% 
  filter(cancer_type == "All") %>% 
  filter(sex == "All") %>% 
  filter(health_board_name == "NHS Borders") %>% 
  mutate(average_number_of_incideneces = mean(number_of_incidences)) %>% 
  mutate(above_below_average = ifelse(number_of_incidences > 705.76, "Above Average", "Below Average"))
  

```

### Show Minimum, Maximum and Averaage Number of Incidences

```{r, echo=FALSE, warning=FALSE, message=FALSE}

health_board_level_clean %>% 
  filter(age_group == "All") %>% 
  filter(cancer_type == "All") %>% 
  filter(sex == "All") %>% 
  filter(health_board_name == "NHS Borders") %>% 
  summarise(minimum_incidences = min(number_of_incidences),
            maximum_incideneces = max(number_of_incidences),
            average_incideneces = mean(number_of_incidences))


```


### End







